+++
date = '2025-09-16T21:23:31+09:00'
draft = true
title = '停止正在执行的函数'
categories= ['Programming']
tags= ['', '']
+++

**如何停止正在执行中的函数，阻止它继续往下执行？**



考虑有这么一个接口：接收用户的问题作为输入，紧接着调用LLM去检测用户问题的意图、调用向量接口将用户的问题转换成向量数组数据、访问全文检索数据库、向量数据库去尝试检索和问题相关的内容片段，再调用外部接口将检索回来的数据重新排序、再经过一些复杂的算法处理环节，最后将所有信息放到一起再次调用LLM，让LLM回答用户的问题。

这个接口来自一个典型的RAG程序，单一接口的背后隐藏了大量逻辑：

1. 调用外部API
2. 访问多个数据库
3. 复杂的算法



但是，如果客户端在请求了接口后很快就取消了该请求怎么办？

> 取消的含义包括：
>
> 1. 用户点击来e页面上的取消提问按钮
> 2. 用户关掉了网页



「什么都不处理」，这是我过去在构建系统时默认的做法。但这次我在想：如果可以在用户取消请求的时候，后端也停掉该接口里后续代码的执行的话，那就太好了，能不能做到呢？









如果编程语言里有这样一个东西：它作为一个单独的代码执行单位，和其他部分独立，不共享内存、资源 。最好极其廉价，创建删除也不心疼。就好了。

是的，这个编程语言叫 Elixir（或者说Erlang）。

Golang有协程，看上去也能满足，那么协程是否满足条件呢？



